var path = require("path");
var fs = require("fs");
var process = require("process");

var uftDeveloperHomePathProvider = {
    "win32": function () {
        var leanFtHomeEnv = process.env.LEANFT_HOME;
        var progFiles = (process.arch === "x64") ? process.env['PROGRAMFILES(X86)'] : process.env.PROGRAMFILES;
        var UFTDeveloperHome = path.join(progFiles, "Micro Focus", "UFT Developer");
        var leanFtHome = path.join(progFiles, "Micro Focus", "LeanFT");
        var uftHome = path.join(progFiles, "Micro Focus", "Unified Functional Testing");

        if (fs.existsSync(leanFtHomeEnv)) {
            return leanFtHomeEnv;
        } else if (fs.existsSync(UFTDeveloperHome)) {
            return UFTDeveloperHome;
        } else if (fs.existsSync(leanFtHome)) {
            return leanFtHome;
        } else {
            return uftHome;
        }
    },
    "linux": function () {
        var leanFtHomeEnv = process.env.LEANFT_HOME;
        var UFTDeveloperHome = "/opt/uftdeveloper";

        if (fs.existsSync(leanFtHomeEnv)) {
            return leanFtHomeEnv;
        } else if (fs.existsSync(UFTDeveloperHome)) {
            return UFTDeveloperHome;
        } else {
            return "/opt/leanft";
        }
    },
    "darwin": function () {
        var leanFtHomeEnv = process.env.LEANFT_HOME;
        var userUFTDeveloperHome = path.join(process.env.HOME, "Applications", "UFTDeveloper");
        var userLeanFtHome = path.join(process.env.HOME, "Applications", "LeanFT");
        var applicationsUFTDeveloperHome = path.join("/", "Applications", "UFTDeveloper");
        var applicationsLeanFtHome = path.join("/", "Applications", "LeanFT");

        if (fs.existsSync(leanFtHomeEnv)) {
            return leanFtHomeEnv;
        } else if (fs.existsSync(userUFTDeveloperHome)) {
            return userUFTDeveloperHome;
        } else if (fs.existsSync(userLeanFtHome)) {
            return userLeanFtHome;
        } else if (fs.existsSync(applicationsUFTDeveloperHome)) {
            return applicationsUFTDeveloperHome;
        } else {
            return applicationsLeanFtHome;
        }
    }
};

module.exports.uftDeveloperHomePathProvider = uftDeveloperHomePathProvider;