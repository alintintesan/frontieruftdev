// (c) Copyright 2015 - 2023 Micro Focus or one of its affiliates..

/** @private */
var ObjectUtils = require("./object_utils.js").ObjectUtils;
var NotifyEventsBehavior = require("./notify_events_behavior.js");

/**
 * An abstraction of an AUT process launched by the user.
 * Note: <para>To launch a new AUT, use: {@link Desktop#launchAut}.
 * @class Aut
 */

 /**
  * Constructor method that is called by the Desktop.launchAut().
  * @param {Session} session The session to which the constructed object belongs.
  * @param {number} cookie A cookie which represents current AUT on the engine
  * @constructor
  * @private
  * @ignore
  */
function Aut(session, cookie, applicationInfo) {
    this._session = session;
    this._cookie = cookie;
    this._applicationInfo = applicationInfo;

    ObjectUtils.extend(this, NotifyEventsBehavior);
}

Aut.prototype = {
    _session: null,
    _cookie: null,
    _applicationInfo: null,
    /**
     * Closes a previously launched AUT.
     */
    close: function() {

        var func = function(){
            var msg = {
                "AUTcookie": this._cookie,
                "operation": "close"
            };

            return this._session._communication.send("ManageAut", msg);
        };

        var options = { sender: this, onError: false, calleeArguments: arguments, type: "Aut"};
        return this.notifyWithEvents(func, arguments, options);
    }
};

module.exports.Aut = Aut;
