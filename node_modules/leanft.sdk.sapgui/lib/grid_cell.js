// (c) Copyright 2015 - 2023 Micro Focus or one of its affiliates..
/*
 * Created on 07/11/2016.
 */
var Core = require("leanft.sdk.core");
var Convert = Core.Convert;
var Utils = Core.ObjectUtils;
var TableCellBase = require("./table_cell_base.js");
var CellBaseOperationsBehavior = TableCellBase.CellBaseOperationsBehavior;
var MergeBehavior = Core.MergeBehavior;

/**
 * A GridCell object
 * @constructor
 * @class GridCell
 * @mixes SAPGUI.CellBaseOperationsBehavior._properties
 * @mixes SAPGUI.CellBaseOperationsBehavior._methods
 * @mixes SAPGUI.GridCellBehavior._methods
 * @memberof SAPGUI
 */
function GridCell(owner, rowIndex, columnIdentifier) {
    Utils.extend(this, MergeBehavior);
    this._mergeBehavior(CellBaseOperationsBehavior);
    this._mergeBehavior(GridCellBehavior);
    this._ownerTable = owner;
    this._rowNumber = this._ownerTable._rowTransform(rowIndex);
    this._columnIdentifier = this._ownerTable._columnTransform(columnIdentifier);
    this._executeWithEventsOnItem = this._ownerTable._executeWithEventsOnItem.bind(this._ownerTable, this);
}

/**
 * The methods of GridCell object
 * @memberof SAPGUI
 * @ignore
 */
GridCell.prototype = {
    _rowNumber: null,
    _columnIdentifier: null,
    _ownerTable: null,
    _executeWithEventsOnItem: null
};

var GridCellBehavior = {
    /**
     * @memberof SAPGUI.GridCellBehavior
     * @ignore
     */
    _methods: {
        /*jshint eqnull:true */
        /**
         * Selects or unselects the checkbox in the grid cell.
         * @function
         * @param {boolean} state The state of the checkbox of this cell.
         * @returns {Promise<void>} a promise that is fulfilled when the operation is performed.
         */
        setCheckBox: function (state) {
            if (state == null)
                throw new Error("The parameter state cannot be null.");
            return this._executeWithEventsOnItem(this._ownerTable._setCheckBox, this._rowNumber, this._columnIdentifier, Convert.toBool(state));
        }
    }
};

module.exports.GridCell = GridCell;
