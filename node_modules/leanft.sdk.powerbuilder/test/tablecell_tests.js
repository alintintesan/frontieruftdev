// (c) Copyright 2015 - 2023 Micro Focus or one of its affiliates..
/*
 * Created on 03/14/2018.
 */

var assert = require("assert");
var sinon = require("sinon");

describe("TableCell", function () {
    var TableCell = require("../lib/table_cell.js").TableCell;
    var tableCellUnderTest;
    var owner;
    beforeEach(function () {
        owner = {owner: "Owner", _executeWithEventsOnItem: sinon.stub(), _executeWithEventsOnItemOnError: sinon.stub()};
        tableCellUnderTest = new TableCell(owner, 0, 0);
        tableCellUnderTest._executeWithEventsOnItem = sinon.stub();
        tableCellUnderTest._executeWithEventsOnItemOnError = sinon.stub();
    });

    describe("Constructor", function () {
        it("should assign correct values", function () {
            var parent = owner;
            tableCellUnderTest = new TableCell(parent, 0, 0);
            assert.strictEqual(tableCellUnderTest._ownerTable, parent);
            assert.strictEqual(tableCellUnderTest._rowIdentifier, 0);
            assert.strictEqual(tableCellUnderTest._columnIdentifier, 0);
        });
    });

    describe("value method", function () {
        it("should execute _getCellValue with correct parameter", function () {
            tableCellUnderTest._ownerTable._getCellValue = sinon.stub();
            tableCellUnderTest.value();
            sinon.assert.calledOnce(tableCellUnderTest._executeWithEventsOnItemOnError);
            sinon.assert.calledWith(tableCellUnderTest._executeWithEventsOnItemOnError, tableCellUnderTest._ownerTable._getCellValue, 0);
        });

        it("should return what's returned from _getCellValue as is", function () {
            tableCellUnderTest._executeWithEventsOnItemOnError.returns("some text");
            var res = tableCellUnderTest.value();
            assert.strictEqual(res, "some text");
        });
    });

    describe("setValue method", function () {
        it("should execute _setCellValue with correct parameter", function () {
            tableCellUnderTest._ownerTable._setCellValue = sinon.stub();
            tableCellUnderTest.setValue("some text");
            sinon.assert.calledOnce(tableCellUnderTest._executeWithEventsOnItem);
            sinon.assert.calledWith(tableCellUnderTest._executeWithEventsOnItem, tableCellUnderTest._ownerTable._setCellValue, 0, 0, "some text");
        });

        it("should return the promise as is", function () {
            var promiseMock = {};
            tableCellUnderTest._executeWithEventsOnItem.returns(promiseMock);
            var res = tableCellUnderTest.setValue("some text");
            assert.strictEqual(res, promiseMock);
        });
    });
});