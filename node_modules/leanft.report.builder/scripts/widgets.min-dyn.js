function WidgetsStrip(a){this._cssNames={stripWrapper:"widgets-strip-wrapper",strip:"widgets-strip",simpleMode:"simple",failState:"status-fail",warnState:"status-warn",widget:"widget",firstWidget:"first-widget",floatLeft:"float-left",floatRight:"float-right",reportCaptionWidget:"report-caption",stesCounterWidget:"steps-counter",widgetContent:"content",layoutItemWrapper:"layout-item-wrapper",layoutItem:"layout-item",statusIndicator:"status-indicator",reportTitle:"title",reportSubtitle:"subtitle",bgIconError24:"bgicon-err24",bgIconWarn24:"bgicon-warn24",bgIconPass24:"bgicon-pass24",counterLabel:"counter-label",sliceLabelContainer:"slice-label-container",sliceLabelNumber:"slice-label-number",sliceLabelText:"slice-label-text",sliceLabelPercent:"slice-label-percent",sliceLabelPass:"slice-label-pass",sliceLabelWarning:"slice-label-warning",sliceLabelError:"slice-label-error"};this._dataModel=a;this._stripWrapper=__uiElements.create_div().addClassNames(this._cssNames.stripWrapper);this._strip=__uiElements.create_div().addClassNames(this._cssNames.strip).appendTo(this._stripWrapper);var b=__commonUtils.general.getValue(this._dataModel.reportStatus,this._dataModel);if(b==="fail"){this._strip.addClassNames(this._cssNames.failState);}else{if(b==="warn"){this._strip.addClassNames(this._cssNames.warnState);}}this._widgets=[];this._widgetsDockLeft=[];this._widgetsDockRight=[];this._adjustableWidget=null;}WidgetsStrip.prototype.addDefaultWidgets=function(){this.addReportCaptionWidget();this.addStepsPieChartWidget(true);return this;};WidgetsStrip.prototype.addReportCaptionWidget=function(b){var c=(this._widgets.length==0);var g=__uiElements.create_div().addClassNames(this._cssNames.widget,this._cssNames.reportCaptionWidget);this._widgets.push(g);this._adjustableWidget=g;if(b){g.addClassNames(this._cssNames.floatRight);this._widgetsDockRight.push(g);}else{g.addClassNames(this._cssNames.floatLeft);this._widgetsDockLeft.push(g);}if(c){g.addClassNames(this._cssNames.firstWidget);}var h=__uiElements.create_div().addClassNames(this._cssNames.widgetContent).appendTo(g);var f=__uiElements.create_div().addClassNames(this._cssNames.layoutItemWrapper).appendTo(h);var d=__uiElements.create_div().addClassNames(this._cssNames.layoutItem).appendTo(f);__uiElements.create_div().addClassNames(this._cssNames.statusIndicator).appendTo(d);var e=__uiElements.create_div().addClassNames(this._cssNames.layoutItem).appendTo(f);__uiElements.create_div().addClassNames(this._cssNames.reportTitle).appendTo(e).setInnerHTML(__commonUtils.general.getValue(this._dataModel.reportName,this._dataModel));if(this._dataModel.reportDesc){var a=__commonUtils.general.getValue(this._dataModel.reportDesc,this._dataModel);__uiElements.create_div().addClassNames(this._cssNames.reportSubtitle).appendTo(e).setInnerHTML(a).setTitle(a);}return this;};WidgetsStrip.prototype.addStepsPieChartWidget=function(a){var c=(this._widgets.length==0);var r=__uiElements.create_div().addClassNames(this._cssNames.widget,this._cssNames.stesCounterWidget);this._widgets.push(r);if(a){r.addClassNames(this._cssNames.floatRight);this._widgetsDockRight.push(r);}else{r.addClassNames(this._cssNames.floatLeft);this._widgetsDockLeft.push(r);}if(c){r.addClassNames(this._cssNames.firstWidget);}var s=__uiElements.create_div().addClassNames(this._cssNames.widgetContent).appendTo(r);errorCount=__commonUtils.general.getValue(this._dataModel.failStepCount,this._dataModel);warningCount=__commonUtils.general.getValue(this._dataModel.warnStepCount,this._dataModel);passCount=__commonUtils.general.getValue(this._dataModel.passStepCount,this._dataModel);var o=new StepsCounterSVGPieChart({errorCount:errorCount,warningCount:warningCount,passCount:passCount});var g=__uiElements.create_div().addClassNames(this._cssNames.layoutItemWrapper).appendTo(s);var e=__uiElements.create_div().addClassNames(this._cssNames.layoutItem).appendTo(g);o.show(e);var m=[];for(var b=0;b<o.Slices.length;b++){var k=o.Slices[b];if(k.type=="error"){m[2]={cssNames:this._cssNames.sliceLabelError,pieSlice:k};}else{if(k.type=="warning"){m[1]={cssNames:this._cssNames.sliceLabelWarning,pieSlice:k};}else{m[0]={cssNames:this._cssNames.sliceLabelPass,pieSlice:k};}}}var f=__uiElements.create_div().addClassNames(this._cssNames.layoutItem).appendTo(g);var l=__uiElements.create_div().addClassNames(this._cssNames.sliceLabelContainer).appendTo(f);var n=__uiElements.create_table().appendTo(l);for(var b=0;b<m.length;b++){var d=m[b];var p=__uiElements.add_table_row(n);var q=__uiElements.add_table_cell(p);__uiElements.create_div().addClassNames(this._cssNames.sliceLabelText,d.cssNames).appendTo(q).setInnerHTML(""+d.pieSlice.label+"&nbsp;");var h=__uiElements.add_table_cell(p);__uiElements.create_div().addClassNames(this._cssNames.sliceLabelNumber,d.cssNames).appendTo(h).setInnerHTML(""+d.pieSlice.count+"&nbsp;");var j=__uiElements.add_table_cell(p);__uiElements.create_div().addClassNames(this._cssNames.sliceLabelPercent,d.cssNames).appendTo(j).setInnerHTML("("+d.pieSlice.roundedPercentage.toLocaleString(__res.get("lang_tag","en"))+"%)");}return this;};WidgetsStrip.prototype.addStepsCounterWidget=function(a){var b=(this._widgets.length==0);var h=__uiElements.create_div().addClassNames(this._cssNames.widget,this._cssNames.stesCounterWidget);this._widgets.push(h);if(a){h.addClassNames(this._cssNames.floatRight);this._widgetsDockRight.push(h);}else{h.addClassNames(this._cssNames.floatLeft);this._widgetsDockLeft.push(h);}if(b){h.addClassNames(this._cssNames.firstWidget);}var i=__uiElements.create_div().addClassNames(this._cssNames.widgetContent).appendTo(h);var g=__uiElements.create_div().addClassNames(this._cssNames.layoutItemWrapper).appendTo(i);var d=__uiElements.create_div().addClassNames(this._cssNames.layoutItem).appendTo(g);__uiElements.create_div().addClassNames(this._cssNames.statusIndicator,this._cssNames.bgIconError24).appendTo(d);var c=__uiElements.create_div().addClassNames(this._cssNames.layoutItem).appendTo(g);__uiElements.create_div().addClassNames(this._cssNames.counterLabel).appendTo(c).setInnerHTML(""+__commonUtils.general.getValue(this._dataModel.failStepCount,this._dataModel));var f=__uiElements.create_div().addClassNames(this._cssNames.layoutItem).appendTo(g);__uiElements.create_div().addClassNames(this._cssNames.statusIndicator,this._cssNames.bgIconWarn24).appendTo(f);var e=__uiElements.create_div().addClassNames(this._cssNames.layoutItem).appendTo(g);__uiElements.create_div().addClassNames(this._cssNames.counterLabel).appendTo(e).setInnerHTML(""+__commonUtils.general.getValue(this._dataModel.warnStepCount,this._dataModel));return this;};WidgetsStrip.prototype.show=function(c){if(c&&this._strip&&this._stripWrapper){for(var a=0;a<this._widgetsDockLeft.length;a++){this._widgetsDockLeft[a].appendTo(this._strip);}for(var b=this._widgetsDockRight.length-1;b>=0;b--){this._widgetsDockRight[b].appendTo(this._strip);}__uiElements.create_cleardiv().appendTo(this._strip);this._stripWrapper.appendTo(c);}return this;};WidgetsStrip.prototype.updateLayout=function(){if(this._strip){this._strip.removeClassNames(this._cssNames.simpleMode);this._adjustableWidget.setWidth(null);var g=0;for(var b=0;b<this._widgets.length;b++){var h=this._widgets[b].getWidth();if(h){g+=h;}}var e=716;var c=160;var a=document.body.clientWidth;if(a<e){a=e;}a-=c;if(g>a){this._strip.addClassNames(this._cssNames.simpleMode);var f=g-this._adjustableWidget.getWidth();var d=a-f;if(d>=0){this._adjustableWidget.setWidth(d);}}}};WidgetsStrip.prototype.getTotalHeight=function(){if(this._stripWrapper){return this._stripWrapper.getHeight();}};function StepsCounterSVGPieChart(a,b){this._data=a||{};this._data.errorCount=this._data.errorCount||0;this._data.warningCount=this._data.warningCount||0;this._data.passCount=this._data.passCount||0;this._data.totalCount=this._data.errorCount+this._data.warningCount+this._data.passCount;this._svgViewBox={x:0,y:0,width:52,height:52};this._settings=b||{};this._settings.chartWidth=this._settings.chartWidth||this._svgViewBox.width;this._settings.chartHeight=this._settings.chartHeight||this._svgViewBox.height;if(!this._settings.cssNames){this._settings.cssNames={};}this._cssNames={svg:this._settings.cssNames.svg||"pie-chart",pie:this._settings.cssNames.pie||"pie-graph",pieSlice:this._settings.cssNames.pieSlice||"pie-slice",pieSliceError:this._settings.cssNames.pieSliceError||"pie-slice-error",pieSliceWarning:this._settings.cssNames.pieSliceWarning||"pie-slice-warning",pieSlicePass:this._settings.cssNames.pieSlicePass||"pie-slice-pass",pieCenterCircle:this._settings.cssNames.pieCenterCircle||"pie-center-circle"};this.Slices=[];this.SVG=null;this._calculateSlices()._createSVG();}StepsCounterSVGPieChart.prototype.show=function(a){if(a){this.SVG.appendTo(a);}return this;};StepsCounterSVGPieChart.prototype._calculateSlices=function(){var c=function(s){var r=0.03;if(s>0&&s<r){return{value:r,compensation:r-s};}else{return{value:s,compensation:0};}};var d=function(s){var r=0.1;var t=Math.round(s*1000)/10;if(s>0&&t<r){return{value:r,forceMin:true};}else{return{value:t,forceMin:false};}};var g=this._data.totalCount<=0?0:this._data.errorCount/this._data.totalCount;var i=this._data.totalCount<=0?0:this._data.warningCount/this._data.totalCount;var h=this._data.totalCount<=0?1:this._data.passCount/this._data.totalCount;var a=c(g);var p=c(i);var e=c(h);var n=a.compensation+p.compensation+e.compensation;if(n>0){var m=[a,p,e];m.sort(function(r,s){return s.value-r.value;});m[0].value-=n;}var b=d(g);var q=d(i);var f=d(h);var o=b.value+q.value+f.value;if(o>100){var m=[b,q,f];m.sort(function(r,s){return s.value-r.value;});if(m[0].value==100){m[0].value=99.90000000000001;}}var j={type:"error",label:__res.get("steps_counter_pie_chart_failed_label","Failed"),pieSliceCSSNames:this._cssNames.pieSliceError,count:this._data.errorCount,rawRatio:g,sliceRatio:a.value,roundedPercentage:b.value};this.Slices.push(j);var l={type:"warning",label:__res.get("steps_counter_pie_chart_warnings_label","Warning(s)"),pieSliceCSSNames:this._cssNames.pieSliceWarning,count:this._data.warningCount,rawRatio:i,sliceRatio:p.value,roundedPercentage:q.value};this.Slices.push(l);var k={type:"pass",label:__res.get("steps_counter_pie_chart_passed_label","Passed"),pieSliceCSSNames:this._cssNames.pieSlicePass,count:this._data.passCount,rawRatio:h,sliceRatio:e.value,roundedPercentage:f.value};this.Slices.push(k);return this;};StepsCounterSVGPieChart.prototype._createSVG=function(){this.SVG=__uiElements.create_svg(this._settings.chartWidth,this._settings.chartHeight,this._svgViewBox.width,this._svgViewBox.height,this._svgViewBox.x,this._svgViewBox.y,this._cssNames.svg);var f=7.5;var g=7.5;var j=(this._svgViewBox.height-2*g)/2;var e=__commonUtils.str.format("translate({0},{1})",f,g);var d=__uiElements.add_svg_group(this.SVG,e,this._cssNames.pie);var l=0;for(var b=0;b<this.Slices.length;b++){var k=this.Slices[b];var n=__commonUtils.str.format("{0}: {1} ({2}%)",k.label,k.count,k.roundedPercentage.toLocaleString(__res.get("lang_tag","en")));if(k.sliceRatio>=1){var o="translate(0,0)";__uiElements.add_svg_circle(d,j,j,j,o,this._cssNames.pieSlice+" "+k.pieSliceCSSNames,n);break;}else{if(k.sliceRatio>0){var h=k.sliceRatio*2*Math.PI;var p=Math.sin(h)*j;var q=j-(Math.cos(h)*j);var m=h>Math.PI?"1":"0";var c=__commonUtils.str.format("M {0} {0} l 0 -{0} a {0} {0} 0 {1} 1 {2} {3} Z",j,m,p,q);var o="translate(0,0)";if(l>0){o=__commonUtils.str.format("rotate({0},{1},{1})",l,j);}l+=k.sliceRatio*360;__uiElements.add_svg_path(d,c,o,this._cssNames.pieSlice+" "+k.pieSliceCSSNames,n);}}}var a=0.71;__uiElements.add_svg_circle(d,j,j,j*a,null,this._cssNames.pieCenterCircle);return this;};